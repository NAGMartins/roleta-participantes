<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Roleta Meo Academia</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background: #f0f0f0;
        margin: 0;
        padding: 20px;
    }
    h1 {
        color: #333;
    }
    #input-area {
        margin-bottom: 20px;
    }
    input {
        padding: 8px;
        font-size: 16px;
    }
    button {
        padding: 8px 12px;
        font-size: 16px;
        margin: 5px;
        cursor: pointer;
    }

    #nomeSelecionado {
       font-size: 24px;
        font-weight: bold;
        margin-top: 20px;
        color: #2196f3;
    position: relative;
    top: -300px;   /* sobe 20 pixels */
    left: 0px;  /* move 50 pixels para a esquerda */
    }
    canvas {
        margin-top: 10px;
        background: white;
        border-radius: 50%;
        display: block;
        margin-left: auto;
        margin-right: auto;
        position: relative;
	top: -100px; /* sobe um pouco */
    	left: -300px; /* move para a esquerda */
}

    /* ContÃªiner para roleta + lista */
    #roleta-container {
        position: relative;
        width: 600px;
        margin: 0 auto;
        display: flex;
        align-items: flex-start;
}
    /* Marcador triÃ¢ngulo fixo no topo da roleta */
    #marcador {
        width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 25px solid Black;
    margin: 0 auto;
    position: relative;
    top: 100px; /* valor atual */
left: 120px;    
transform: rotate(-89deg);
 z-index: 10; 
    }
 /* Lista Ã  direita da roleta */
    #participantesLista {
        white-space: pre-line;
        text-align: left;
        font-size: 18px;
        max-height: 270px;
        overflow-y: auto;
        border: 1px solid #ccc;
        padding: 10px;
        background: #fff;
        width: 170px;
        margin-left: 24px;
        display: inline-block;
    }
</style>
</head>
<body>

<h1>ðŸŽ¯ Roleta de Participantes</h1>

<img src="logo.png" alt="Logotipo" width="300" height="50" style="display:block; margin: 0 auto;">

<div id="input-area">
    <input type="text" id="nome" placeholder="Digite o nome">
    <button onclick="adicionarNome()">Adicionar</button>
</div>

<div>
    <button onclick="rodarRoleta()">Rodar Roleta</button>
    <button onclick="reiniciar()">Reiniciar</button>
</div>

<!-- Nova estrutura para roleta + marcador + lista Ã  direita -->
<div id="roleta-container">
    <div id="marcador"></div>
    <canvas id="roleta" width="400" height="400"></canvas>
    <span id="participantesLista"></span>
</div>

<p id="nomeSelecionado"></p>

<script>
    let participantes = [];
    let sorteados = [];
    const canvas = document.getElementById("roleta");
    const ctx = canvas.getContext("2d");

    // Paleta de cores para diferenciar os nomes (cores distintas)
    const cores = [
        "#e6194b", "#3cb44b", "#ffe119", "#4363d8", "#f58231", 
        "#911eb4", "#46f0f0", "#f032e6", "#bcf60c", "#fabebe", 
        "#008080", "#e6beff", "#9a6324", "#fffac8", "#800000", 
        "#aaffc3", "#808000", "#ffd8b1", "#000075", "#808080"
    ];

    let anguloAtual = 0; // Ã¢ngulo corrente da roleta
    let animando = false;

    function adicionarNome() {
        const nome = document.getElementById("nome").value.trim();
        if (nome && !participantes.includes(nome)) {
            participantes.push(nome);
            atualizarLista();
        }
        document.getElementById("nome").value = '';
    }

    function atualizarLista() {
        document.getElementById("participantesLista").innerText = participantes.join(", ");
        desenharRoleta(anguloAtual);
    }

    function desenharRoleta(angulo) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        if (participantes.length === 0) return;

        const segmentos = participantes.length;
        const anguloSegmento = 2 * Math.PI / segmentos;

        ctx.save();
        ctx.translate(200, 200);
        ctx.rotate(angulo);
        
        for (let i = 0; i < segmentos; i++) {
            ctx.beginPath();
            ctx.moveTo(0, 0);
            ctx.fillStyle = cores[i % cores.length];
            ctx.arc(0, 0, 200, i * anguloSegmento, (i + 1) * anguloSegmento);
            ctx.lineTo(0, 0);
            ctx.fill();

            ctx.save();
            ctx.rotate(i * anguloSegmento + anguloSegmento / 2);
            ctx.textAlign = "right";
            ctx.fillStyle = "#000";
            ctx.font = "16px Arial";
            ctx.fillText(participantes[i], 180, 5);
            ctx.restore();
        }
        ctx.restore();
    }

    function rodarRoleta() {
        if (participantes.length === 0) {
            alert("Adicione participantes primeiro!");
            return;
        }
        if (participantes.length === sorteados.length) {
            alert("Todos os nomes jÃ¡ foram sorteados!");
            return;
        }
        if (animando) return; // nÃ£o permite novo sorteio enquanto anima
        
        animando = true;

        let indiceSorteado;
        do {
            indiceSorteado = Math.floor(Math.random() * participantes.length);
        } while (sorteados.includes(participantes[indiceSorteado]));

        sorteados.push(participantes[indiceSorteado]);

        // Gira a roleta atÃ© o Ã­ndice sorteado, com animaÃ§Ã£o suave
        const segmentos = participantes.length;
        const anguloSegmento = 2 * Math.PI / segmentos;
        
        // Queremos que o segmento sorteado fique no topo (Ã¢ngulo 0)
        // Considerando que a roleta gira, o Ã¢ngulo para o segmento i no topo Ã©: -(i * anguloSegmento + anguloSegmento/2)
        // Faremos vÃ¡rias voltas + a rotaÃ§Ã£o final para suavizar a animaÃ§Ã£o
        const voltas = 5;
        const anguloFinal = - (indiceSorteado * anguloSegmento + anguloSegmento / 2);
        const duracao = 4000; // duraÃ§Ã£o da animaÃ§Ã£o em ms
        const inicio = performance.now();
        const anguloInicio = anguloAtual;

        function animar(time) {
            const fase = (time - inicio) / duracao;
            if (fase >= 1) {
                anguloAtual = anguloFinal;
                desenharRoleta(anguloAtual);
                animando = false;
                document.getElementById("nomeSelecionado").innerText = "ðŸŸ¢ Sorteado: " + participantes[indiceSorteado];
                return;
            }
            // Usa ease out para animaÃ§Ã£o
            const easeOut = (t) => 1 - Math.pow(1 - t, 3);
            const anguloInterp = anguloInicio + (2 * Math.PI * voltas + anguloFinal - anguloInicio) * easeOut(fase);
            anguloAtual = anguloInterp;
            desenharRoleta(anguloAtual);
            requestAnimationFrame(animar);
        }
        requestAnimationFrame(animar);
    }

    function reiniciar() {
        participantes = [];
        sorteados = [];
        anguloAtual = 0;
        animando = false;
        atualizarLista();
        document.getElementById("nomeSelecionado").innerText = "";
    }

    // Inicializa a roleta vazia
    desenharRoleta(anguloAtual);
</script>

</body>
</html>